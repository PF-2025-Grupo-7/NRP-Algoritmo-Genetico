{% extends 'base.html' %}

{% block content %}
<div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <!-- Encabezado -->
            <div class="row mb-4 align-items-center">
                <div class="col-md-8">
                    <h1 class="h2 fw-bold mb-1" style="color: #2f3e4c;">Configuración Avanzada</h1>
                    <p class="text-muted fs-5 mb-0">Control detallado de parámetros del algoritmo genético</p>
                </div>
            </div>

            <form method="post">
                {% csrf_token %}
                
                <div class="card shadow-sm border-0">
                    <div class="card-header bg-white border-bottom-0">
                        <ul class="nav nav-tabs card-header-tabs" id="myTab" role="tablist">
                            <li class="nav-item">
                                <button class="nav-link active fw-bold" id="tech-tab" data-bs-toggle="tab" data-bs-target="#tech" type="button">
                                    Parámetros Técnicos
                                </button>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link fw-bold" id="biz-tab" data-bs-toggle="tab" data-bs-target="#biz" type="button">
                                    Pesos de Negocio
                                </button>
                            </li>
                        </ul>
                    </div>
                                
                    <div class="card-body p-4">
                        <div class="tab-content" id="myTabContent">
                            
                            <div class="tab-pane fade show active" id="tech">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label fw-bold">Nombre Configuración</label>
                                        {{ form.nombre }}
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label fw-bold">Semilla (Opcional)</label>
                                        {{ form.semilla }}
                                    </div>
                                </div>
                                <hr>
                                <h6 class="text-primary mb-3">Algoritmo Genético</h6>
                                <div class="row">
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">Población</label>
                                        {{ form.tamano_poblacion }}
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">Generaciones</label>
                                        {{ form.generaciones }}
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">Prob. Cruce</label>
                                        {{ form.prob_cruce }}
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">Prob. Mutación</label>
                                        {{ form.prob_mutacion }}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label">Selección</label>
                                        {{ form.estrategia_seleccion }}
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label">Cruce</label>
                                        {{ form.estrategia_cruce }}
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label">Mutación</label>
                                        {{ form.estrategia_mutacion }}
                                    </div>
                                </div>
                                <div class="form-check mt-2">
                                    {{ form.elitismo }}
                                    <label class="form-check-label" for="{{ form.elitismo.id_for_label }}">Activar Elitismo</label>
                                </div>
                            </div>

                            <div class="tab-pane fade" id="biz">
                                <h6 class="text-primary mb-1">Ponderación de Objetivos (Pesos)</h6>
                                <p class="text-muted small mb-3">Cuanto mayor es el número, más importancia le dará el algoritmo a esa regla.</p>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Peso Equidad General</label>
                                        {{ form.peso_equidad_general }}
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Peso Turnos Difíciles</label>
                                        {{ form.peso_equidad_dificil }}
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Peso Días Libres (Preferencias)</label>
                                        {{ form.peso_preferencia_dias_libres }}
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Peso Turno Específico (Preferencias)</label>
                                        {{ form.peso_preferencia_turno }}
                                    </div>
                                </div>
                                <hr>
                                <h6 class="text-primary mb-3">Tolerancias y Factores</h6>
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label">Tolerancia Gral (Horas)</label>
                                        {{ form.tolerancia_general }}
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label">Tolerancia Difícil (Turnos)</label>
                                        {{ form.tolerancia_dificil }}
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label">Factor Alpha (PTE)</label>
                                        {{ form.factor_alpha_pte }}
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    
                    <div class="card-footer bg-white border-0 text-end p-4">
                        <a href="{% url 'config_dashboard' %}" class="btn btn-outline-secondary me-2 fw-bold">Cancelar</a>
                        <button type="submit" class="btn btn-primary fw-bold px-4">Guardar Configuración</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
    /* Estilos personalizados para las pestañas */
    
    /* 1. Estado Inactivo: Texto gris */
    .card-header-tabs .nav-link {
        color: #6c757d; 
        border: none;
        transition: all 0.3s ease;
    }
    
    /* 2. Al pasar el mouse (Hover): Texto azul primario */
    .card-header-tabs .nav-link:hover {
        color: #0d6efd;
        border: none;
    }
    
    /* 3. Estado Activo: Texto azul primario y borde inferior */
    .card-header-tabs .nav-link.active {
        color: #0d6efd;
        background-color: transparent;
        border-bottom: 2px solid #0d6efd;
    }
</style>
{% endblock %}